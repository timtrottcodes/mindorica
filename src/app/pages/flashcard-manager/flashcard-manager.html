<div class="container mt-4">
  <h2>Flashcards for "{{ topicName }}"</h2>

  <div class="mb-4">
    <p>
      Here you can create, edit, and organize your flashcards within the selected topic.
      Each flashcard has a <em>front</em> (the question or prompt) and a <em>back</em> (the answer or explanation).
    </p>
    <p>
      To add a new flashcard, use the <strong>Add Flashcard</strong> button and fill in the fields.
      You can also edit existing cards or move them between topics using the dropdown menu.
    </p>
    <p>
      Keep your flashcards organized by assigning them to the appropriate topics and subtopics.
      This will make studying more effective and focused.
    </p>
  </div>

  <div class="row my-4">
    <div class="col-md-6">
      <form (submit)="saveFlashcard(); $event.preventDefault()" class="mt-4">
        <div class="mb-2">
          <input
            class="form-control"
            [(ngModel)]="editCard.front"
            name="front"
            placeholder="Front text"
            required
          />
        </div>
        <div class="mb-2">
          <input
            class="form-control"
            [(ngModel)]="editCard.back"
            name="back"
            placeholder="Back text"
            required
          />
        </div>
        <div class="d-flex gap-2">
          <button class="btn btn-success" type="submit">
            {{ editCard.id ? "Update" : "Add" }} Flashcard
          </button>
          <button
            *ngIf="editCard.id"
            class="btn btn-secondary"
            type="button"
            (click)="cancelEdit()"
          >
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>

  <div class="row g-3">
    <div *ngFor="let topicId of getTopicIds(groupedFlashcards)" class="mb-4">
      <h5 class="border-bottom pb-1">{{ topicId }}</h5>

      <ul class="list-group mt-3">
        <li *ngFor="let card of groupedFlashcards[topicId]" class="list-group-item">
          <div
            class="d-flex justify-content-between align-items-start flex-column flex-md-row"
          >
            <div class="mb-2 mb-md-0">
              <strong>{{ card.front }}</strong>
              <div class="text-muted">{{ card.back }}</div>
            </div>
            <div class="d-flex align-items-center flex-wrap gap-2">
              <select
                class="form-select form-select-sm w-auto"
                [ngModel]="card.topicId"
                (ngModelChange)="moveCard(card)"
              >
                <option *ngFor="let topic of allTopics" [value]="topic.id">
                  {{ topic.id }}
                </option>
              </select>
              <button
                class="btn btn-sm btn-outline-primary"
                (click)="startEdit(card)"
              >
                Edit
              </button>
              <button
                class="btn btn-sm btn-outline-danger"
                (click)="requestDelete(card)"
              >
                Delete
              </button>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div
  class="modal fade"
  id="deleteConfirmModal"
  tabindex="-1"
  aria-labelledby="deleteConfirmModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title" id="deleteConfirmModalLabel">
          Confirm Deletion
        </h5>
        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        Are you sure you want to delete this flashcard?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Cancel
        </button>
        <button type="button" class="btn btn-danger" (click)="confirmDelete()">
          Delete
        </button>
      </div>
    </div>
  </div>
</div>
